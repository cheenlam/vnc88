<div class="contBox-min broadcast">
    <!-- liveBox start -->
    <div class="liveBox">
        <div class="liveTitle">
            <img src="images/icon/hot.gif">
            <span>Truyền hình trực tiếp</span>
        </div>
        <div class="liveList" id="liveList">
            <ul></ul>
        </div>
        <div class="liveBtn">
            <div class="btn_linear_c2 btn">
                <div class="btn_cnt">Xem tất cả</div>
            </div>
        </div>
    </div>

    <div class="videoBanner">
        <img src="images/videoBanner-01.jpg">
    </div>

    <div class="mainMsg">
        <div class="mainMsg-title">VIDEO</div>
        <!-- videoBox start -->
        <div class="videoBox">
            <div class="gameShow" id="gameShow">
                <div class="main">
                    <iframe src="" frameborder="0" id="showMv"></iframe>
                </div>
                <div class="list">
                    <div class="arrow_l"></div>
                    <div class="arrow_r"></div>
                    <div class="listArray" id="listArray">
                        <ul></ul>
                    </div>
                </div>
            </div>
            <div class="gameMsg" id="gameMsg">
                <div class="gameChart">
                    <select>
                        <option value="1">Chọn giải đấu</option>
                        <option value="2">Cúp C1</option>
                    </select>
                    <div class="gameChart_tb" id="gameChart_tb">
                        <table>
                            <tr>
                                <th>TT</th>
                                <th>Đội</th>
                                <th>Trận</th>
                                <th>HS</th>
                                <th>Điểm</th>
                            </tr>
                        </table>
                    </div>
                </div>
                <div class="gameSchedule">
                    <div class="gameSchedule_tb" id="gameSchedule_tb">
                        <table></table>
                    </div>
                </div>
            </div>
        </div>

        <!-- scheduleList start (時程表) -->
        <div class="scheduleList" id="scheduleList">
            <div class="mainMsg-title">LỊCH THI ĐẤU</div>
            <!-- dateList -->
            <div class="dateList">
                <div class="today">14/07/2021</div>
                <ul></ul>
            </div>
            <!-- matchList -->
            <div class="matchList">
                <table></table>
            </div>
        </div>
    </div>
</div>




<script>
    var arrayNum = 0;
    var movieArray = []
    $('#gameShow .arrow_l').click(function() {
        arrayNum == 0 ? 0 : arrayNum--;
        $('#listArray ul').css('transform', `translateX(-${arrayNum*23}%)`)
    })

    $('#gameShow .arrow_r').click(function() {
        arrayNum == 3 ? 3 : arrayNum++;
        $('#listArray ul').css('transform', `translateX(-${arrayNum*23}%)`)
    })


    docRef.get().then((querySnapshot) => {
        querySnapshot.forEach((doc) => {
            let data = doc.data();
            let liData = `<li>
                            <div>
                                <div class="liveList_mv">
                                    <iframe src="https://www.youtube.com/embed/${data.videoId}" frameborder="0"></iframe>
                                </div>
                                <div class="liveList_msg">${data.title}</div>
                            </div>
                        </li>`
            $('#liveList ul').append(liData);
        });

        getMovie()
    })

    function getMovie() {
        docRef2.get().then((querySnapshot) => {
            querySnapshot.forEach((doc) => {
                let data = doc.data();
                let liData = `<li videoId="${data.videoId}" onclick="chMovie(this)">
                            <div>
                                <div class="listArray_img">
                                    <img src="${data.imgUrl}">
                                </div>
                                <div class="listArray_msg">
                                    <span>${data.time}</span>
                                    <p>${data.title}</p>     
                                </div>
                            </div>
                        </li>`

                $('#listArray ul').append(liData);
                movieArray.push(data.videoId);
                $('#gameShow iframe').attr('src', `https://www.youtube.com/embed/${movieArray[0]}`)
            });
        })
    }

    function chMovie(e) {
        let getId = $(e).attr('videoid')
        $('#gameShow iframe').attr('src', `https://www.youtube.com/embed/${getId}`)
    }


    // 靜態假資料
    var chartData = [{
        sort: 'Bảng A',
        list: [{
            flagUrl: 'images/flag/italy.png',
            name: 'Italy',
            num: [3, 7, 9]
        }, {
            flagUrl: 'images/flag/wales.png',
            name: 'Wales',
            num: [3, 1, 4]
        }, {
            flagUrl: 'images/flag/switzerland.png',
            name: 'Switzerland',
            num: [3, -1, 4]
        }, {
            flagUrl: 'images/flag/turkey.png',
            name: 'Turkey',
            num: [3, -7, 0]
        }]
    }, {
        sort: 'Bảng B',
        list: [{
            flagUrl: 'images/flag/belgium.png',
            name: 'Belgium',
            num: [3, 6, 9]
        }, {
            flagUrl: 'images/flag/denmark.png',
            name: 'Denmark',
            num: [3, 1, 3]
        }, {
            flagUrl: 'images/flag/finland.png',
            name: 'Finland',
            num: [3, -2, 3]
        }, {
            flagUrl: 'images/flag/russia.png',
            name: 'Russia',
            num: [3, -5, 3]
        }]
    }, ];
    var scheduleData = [{
        sort: 'Premier League 24/07/2021',
        list: [{
            club_1_name: 'CSKA Moscow',
            club_1_badge: 'images/badge/cska-moscow.png',
            club_2_name: 'Ufa',
            club_2_badge: 'images/badge/ufa.png',
            saibe: 'CONCACAF Gold Cup',
            time: '19:30',
            day: '24/07/2021',
            live: true,
        }, {
            club_1_name: 'FK Krylya Sovetov Samara',
            club_1_badge: 'images/badge/FK-Krylya-Sovetov-Samara.png',
            club_2_name: 'Akhmat Grozny',
            club_2_badge: 'images/badge/akhmat-grozny.png',
            saibe: 'Liga Mexico',
            time: '20:00',
            day: '24/07/2021',
            live: true,
        }, {
            club_1_name: 'FK Rostov',
            club_1_badge: 'images/badge/fk-rostov.png',
            club_2_name: 'Dynamo Moscow',
            club_2_badge: 'images/badge/dynamo-moscow.png',
            saibe: 'Giao Hữu CLB',
            time: '20:00',
            day: '24/07/2021',
            live: false,
        }, {
            club_1_name: 'Khimki',
            club_1_badge: 'images/badge/khimk.png',
            club_2_name: 'Zenit',
            club_2_badge: 'images/badge/zenit.png',
            saibe: 'Ngoại Hạng Banglades',
            time: '22:00',
            day: '24/07/2021',
            live: false,
        }, ]
    }]

    // 影片區側邊比賽訊息
    function dataEach_1() {
        chartData.forEach(function(data) {
            let combination = ''
            combination += `<tr>
                            <td colspan="5" class="sort">${data.sort}</td>
                        </tr>`
            let getData = data;
            for (let i = 0; i < getData.list.length; i++) {
                let data = getData.list[i];

                combination += `<tr>
                                <td>${i+1}</td>
                                <td>
                                    <div class="flag">
                                        <img src="${data.flagUrl}">
                                    </div>
                                    <span>${data.name}</span>
                                </td>
                                <td>${data.num[0]}</td>
                                <td>${data.num[1]}</td>
                                <td>${data.num[2]}</td>
                            </tr>`
            }

            $('#gameChart_tb table').append(combination);
        })
    }

    function dataEach_2() {
        scheduleData.forEach(function(data) {
            let combination = ''
            combination += `<tr>
                            <th colspan="3">${data.sort}</th>
                        </tr>`
            let getData = data;
            for (let i = 0; i < getData.list.length; i++) {
                let data = getData.list[i];
                combination += ` <tr>
                                <td>
                                    <div class="club_1">
                                        <span>${data.club_1_name}</span>
                                        <div class="badge">
                                            <img src="${data.club_1_badge}">
                                        </div>
                                    </div>
                                </td>
                                <td>
                                    <span class="time">${data.time}</span>
                                </td>
                                <td>
                                    <div class="club_2">
                                        <div class="badge">
                                            <img src="${data.club_2_badge}">
                                        </div>
                                        <span>${data.club_2_name}</span>
                                    </div>
                                </td>
                            </tr>`
            }
            $('#gameSchedule_tb table').append(combination);
        })

    }

    for (let i = 0; i < 5; i++) {
        dataEach_1()
        dataEach_2()
        dataEach_3()
    }

    // 日程表今日日期
    var scheduleToday = new Date();

    function formatDate(date) {
        let formatted_date = date.getDate() + "/" + (date.getMonth() + 1) + "/" + date.getFullYear()
        return formatted_date;
    }
    $('#scheduleList .dateList .today').html(formatDate(scheduleToday));

    // 日程表清單日期(抓今日時間更新); 
    var scheduleWeek = []
    var scheduleNum = []
    var weekTxt = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday']
    scheduleWeek[3] = weekTxt[new Date().getDay()];
    scheduleNum[3] = new Date().getDate();

    for (let i = 1; i < 4; i++) {
        let week = [];
        for (let k = 0; k < 4; k++) {
            week[k] = new Date()
        };
        let getWeek_cut = weekTxt[new Date(week[0].setDate(week[0].getDate() - i)).getDay()];
        let getWeek_plus = weekTxt[new Date(week[1].setDate(week[1].getDate() + i)).getDay()];
        let getNum_cut = new Date(week[2].setDate(week[2].getDate() - i)).getDate();
        let getNum_plus = new Date(week[3].setDate(week[3].getDate() + i)).getDate();
        scheduleWeek[3 - i] = getWeek_cut;
        scheduleWeek[3 + i] = getWeek_plus;
        scheduleNum[3 - i] = getNum_cut;
        scheduleNum[3 + i] = getNum_plus;
    }

    for (let i = 0; i < scheduleWeek.length; i++) {
        let dateList = `<li>
                       <div class="date_num">${scheduleNum[i]}</div>
                       <div class="date_week">${scheduleWeek[i]}</div>
                    </li>`
        $('#scheduleList .dateList ul').append(dateList);
    }


    function dataEach_3() {
        scheduleData.forEach(function(data) {
            let combination = ''
            let getData = data;
            for (let i = 0; i < getData.list.length; i++) {
                let data = getData.list[i];

                combination += ` <tr>
                                    <td>
                                        <div class="match_title ${data.live == true?'on':''}">
                                            <div class="match_time">
                                                <p>${data.time} - ${data.day}</p>
                                                <div class="match_live">live</div>
                                            </div>
                                            <p>${data.saibe}</p>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="match_teams">
                                            <div class="team team_L">
                                                <span>${data.club_1_name}</span>
                                                <div class="team_flag">
                                                    <img src="${data.club_1_badge}">
                                                </div>                            
                                            </div>
                                            <div class="vs">VS</div>
                                            <div class="team team_R">
                                                <div class="team_flag">
                                                    <img src="${data.club_2_badge}">
                                                </div>
                                                <span>${data.club_2_name}</span>
                                            </div>
                                        </div>
                                    </td>
                                </tr>`
            }

            $('#scheduleList .matchList table').append(combination);
        })
    }
</script>

<!-- matchList -->

<script src="js/index.js"></script>